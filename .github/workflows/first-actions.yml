name: Python CI/Tests

on: 
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main ]

jobs:
  build:
    runs-on: ubuntu-latest 

    strategy:
      matrix:
        python-version: ["3.9", "3.10", "3.11"] 

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v4 

    - name: Set up Python ${{ matrix.python-version }}
      uses: actions/setup-python@v5 
      with:
        python-version: ${{ matrix.python-version }}

    # Cache step remains the same, as requirements.txt is in the root
    - name: Cache dependencies
      uses: actions/cache@v3
      with:
        path: ~/.cache/pip
        key: ${{ runner.os }}-pip-${{ hashFiles('requirements.txt') }}
        restore-keys: |
          ${{ runner.os }}-pip-

    - name: Install dependencies
      # This will now successfully read the requirements.txt file from the root
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt 

    # ðŸš¨ CRITICAL PATH ADJUSTMENT ðŸš¨
    # If app.py and your tests are in the 'src' folder, you need to tell pytest where to find them.
    - name: Run Tests with Pytest
      run: |
        # 1. Install your code as a package (best practice for testing)
        # pip install ./src 
        
        # 2. Run pytest, targeting the specific file path or a directory
        # The path 'src/addition.py' assumes your app.py is inside the src folder.
        python -m pytest src/addition.py
        
        # If you have tests in the 'example' folder that also failed, you might
        # need to run pytest on both folders:
        # python -m pytest src/ example/
